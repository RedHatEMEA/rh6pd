<html><body>
<img src="redhat_logo.png" alt="JBoss"/>
<h1>Start Insurance Demo!</h1>

<p> Red Hat Car Insurance </p>

<img src="auto_insurance-car.png" alt="JBoss"width="400" height="150"/>
	

<div id="placeholder"></div>
<div id="action"></div>

<script>
//helper function to create the form
function getNewSubmitForm(){
 var submitForm = document.createElement("FORM");
 document.body.appendChild(submitForm);
 submitForm.method = "POST";
 return submitForm;
}

//helper function to add elements to the form
function createNewFormElement(inputForm, elementName, elementValue){
 var newElement = document.createElement("<input name='"+elementName+"' type='hidden'>");
 inputForm.appendChild(newElement);
 newElement.value = elementValue;
 return newElement;
}

//function that creates the form, adds some elements
//and then submits it
function createFormAndSubmit(){
 var submitForm = getNewSubmitForm();
 //createNewFormElement(submitForm, "field1", "somevalue");
 //createNewFormElement(submitForm, "field2", "somevalue");
 submitForm.action= action;
 submitForm.submit();
}

// now create the ajax connection and get the list of process definitions.
var action = "EMPTY";
//var data = {"definitions":[{"id":"org.jbpm.evaluation.carinsurance.hello","name":"hello","version":0,"packageName":"org.jbpm.evaluation.carinsurance","deploymentId":"N/A","suspended":false,"diagramUrl":"http://localhost:8080/jboss-brms/org.drools.guvnor.Guvnor/package/org.jbpm.evaluation.carinsurance/LATEST/org.jbpm.evaluation.carinsurance.hello-image.png"},{"id":"org.jbpm.evaluation.carinsurance.Quote","name":"Quote179","version":0,"packageName":"org.jbpm.evaluation.carinsurance","deploymentId":"N/A","suspended":false,"formUrl":"http://localhost:8080/business-central-server/rs/form/process/org.jbpm.evaluation.carinsurance.Quote/render","diagramUrl":"http://localhost:8080/jboss-brms/org.drools.guvnor.Guvnor/package/org.jbpm.evaluation.carinsurance/LATEST/org.jbpm.evaluation.carinsurance.Quote-image.png"}]}
var url="http://localhost:8080/business-central-server/rs/process/definitions";
var http_request = new XMLHttpRequest();

http_request.open("GET", url, true);
http_request.onreadystatechange = function () 
{
    var done = 4, ok = 200;
  
    if (http_request.readyState == done && http_request.status == ok) 
    {
        data = JSON.parse(http_request.response);
       
        var output="<ul>";
        console.log(data);
     
        for (var i in data.definitions) 
        {
            output+="<li>" + "Availabe Process Business Process is :- " + data.definitions[i].name + "<br>" + data.definitions[i].packageName+"</li>";
        	action = "http://localhost:8080/business-central-server/rs/process/definition/" + data.definitions[i].id + "/new_instance";
        	document.getElementById("placeholder").innerHTML=output;
            //document.getElementById("action").innerHTML=action;
        }
        output+="</ul>";
    }
}
http_request.send(null);

</script>

<input type="button" value="START QUOTE" onclick="createFormAndSubmit()">

</body></html>
